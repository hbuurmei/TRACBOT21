<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Electrical | TRACBOT21 </title> <meta name="author" content="Hugo Buurmeijer"> <meta name="description" content="Project website of TRACTBOT21. "> <meta name="keywords" content="mechatronics"> <link rel="stylesheet" href="/TRACBOT21/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/TRACBOT21/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/TRACBOT21/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/TRACBOT21/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://hbuurmei.github.io/TRACBOT21/electrical/"> <link defer rel="stylesheet" href="/TRACBOT21/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/TRACBOT21/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/TRACBOT21//"> TRACBOT21 </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/TRACBOT21/">Home </a> </li> <li class="nav-item "> <a class="nav-link" href="/TRACBOT21/approach/">Approach </a> </li> <li class="nav-item dropdown active"> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Design <span class="sr-only">(current)</span> </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/TRACBOT21/mechanical/">Mechanical</a> <div class="dropdown-divider"></div> <a class="dropdown-item active" href="/TRACBOT21/electrical/">Electrical</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/TRACBOT21/software/">Software</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/TRACBOT21/materials/">Materials </a> </li> <li class="nav-item "> <a class="nav-link" href="/TRACBOT21/results/">Results </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Electrical</h1> <p class="post-description"></p> </header> <article> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/TRACBOT21/assets/img/power_distribution_drive_train-480.webp 480w,/TRACBOT21/assets/img/power_distribution_drive_train-800.webp 800w,/TRACBOT21/assets/img/power_distribution_drive_train-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/TRACBOT21/assets/img/power_distribution_drive_train.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/TRACBOT21/assets/img/ir_sensors_electrical-480.webp 480w,/TRACBOT21/assets/img/ir_sensors_electrical-800.webp 800w,/TRACBOT21/assets/img/ir_sensors_electrical-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/TRACBOT21/assets/img/ir_sensors_electrical" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/TRACBOT21/assets/img/i2c_components_electrical-480.webp 480w,/TRACBOT21/assets/img/i2c_components_electrical-800.webp 800w,/TRACBOT21/assets/img/i2c_components_electrical-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/TRACBOT21/assets/img/i2c_components_electrical.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The electrical diagrams for the TRACBOT21. On the left is the schematic of the drive train, in the center the IR sensors, and on the right the IMU plus servos. Click to enlarge. </div> <h3 id="power-distribution">Power Distribution</h3> <p>Our robot was powered by two 7V2 battery packs attached in a series configuration to provide a total of 14V4. Several voltage regulators were used in order to manage power disribution to the rest of the robot:</p> <ul> <li>Two 12V regulators in parallel to the drive train (using multiple increases acceptable drive train current draw)</li> <li>One 12V regulator to the Arduino Uno</li> <li>One 5V regulator to the Servos</li> </ul> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/TRACBOT21/assets/img/power_distribution-480.webp 480w,/TRACBOT21/assets/img/power_distribution-800.webp 800w,/TRACBOT21/assets/img/power_distribution-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/TRACBOT21/assets/img/power_distribution.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Power Distribution Electronics" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The 12V regulator used was the L7812, and the 5V regulator was the M1084. All were attached to the 14V4 supply; however, a potential improvement here to reduce wasted energy would be to supply the 5V regulator with a single 7V2 battery to reduce the voltage drop.</p> <h3 id="drive-train">Drive Train</h3> <p>The drive train electronics were run off the L289N motor driver with a 12V power supply. Logic supply was taken from the Uno at 5V. Two 12V Greartisan DC Motors were selected for the drive train, and a the 100RPM configuration was chosen as this provided a good balance between maximum speed and speed range. Initially we selected the 200RPM configuration, but ultimately found that the minimum loaded speed was too high to enable precise turning. Luckily, this vendor has many different options with the same motor geometry, making it easy to iterate without redesigning the motor mount assembly.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/TRACBOT21/assets/img/L298-480.webp 480w,/TRACBOT21/assets/img/L298-800.webp 800w,/TRACBOT21/assets/img/L298-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/TRACBOT21/assets/img/L298.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="L298N Motor Driver" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Both motors were driven by a PWM signal to the enable pins for speed control. The pins used were specifically chosen to be on the same hardware timer (ITimer2) to improve consistency between the motor behavior.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/TRACBOT21/assets/img/power_distribution_drive_train-480.webp 480w,/TRACBOT21/assets/img/power_distribution_drive_train-800.webp 800w,/TRACBOT21/assets/img/power_distribution_drive_train-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/TRACBOT21/assets/img/power_distribution_drive_train.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 id="swivel--deposit-servos">Swivel &amp; Deposit Servos</h3> <p>The robot uses two servo motors:</p> <ul> <li>A DS3218MG high-torque servo to move the ball-deposit swivel, which is also used to orient the IR beacon.</li> <li>A micro servo to release balls from the swivel tube.</li> </ul> <p>In an early design, both servos were driven using PWM signals generated from the Arudino. However this system proved to be unreliable, likely due to the use of the Arduino hardware timers for other tasks. The servos would jitter and fail to maintain a consistent position.</p> <p>Instead, we elected to use a PCA9685 I2C servo driver breakout board provided by a member of our team. This driver allows up to 16 servos to be controlled independently, with an onboard clock providing the timing signal for PWM frequency and duty cycle. The PWM duty cycle, which determines servo position, is set by I2C message and is maintained until a subsequent message is received.</p> <p>Both servos are powered by a dedicated 5V regulator.</p> <h3 id="beacon-sensing">Beacon Sensing</h3> <p>The beacon sensing subsystem is based on an LTR-3208E phototransistor sourced from our lab kit mounted on the robot swivel. The overall purpose of this circuit is to provide an analog voltage level corresponding to the strength of the 3333 Hz beacon signal received by the phototransistor: this allows the robot to measure the direction of maximum received signal and thereby orient itself relative to the IR beacon.</p> <p>Our original intention was to use the beacon both for determining initial orientation and for guidance as the robot moves between the contact zone, shooting zone, and ramp. This requires a circuit with extremely high dynamic range as the intensity of the beacon signal decreases with the <em>square</em> of the distance from the beacon. To address this, we designed a two-stage amplification circuit and intended to use an analog multiplexer to select between the output of the first amplifier, which provided moderate gain suitable for use close to the beacon, and second amplifier, which further amplified the signal for use in the starting zone. However as the project progressed we elected to drop the requirement for beacon sensing close to the beacon and replaced the analog multiplexer with a mechanical switch: This allowed us to continue to use the moderate-gain setting for testing, and the high-gain setting for initial orientation.</p> <p>The basic sections of the circuit are:</p> <ul> <li>A transresistive amplifier with offset voltage to convert the phototransistor current signal into a voltage signal.</li> <li>A DC-blocking filter with offset voltage.</li> <li>Two noninverting amplifier circuits, each with a DC-blocking high pass filter on the output.</li> <li>A mechanical switch allowing selection between the output of the first amplifier and the output of the second amplifier.</li> <li>A final low pass filter to reduce high frequency interference.</li> <li>A peak detection circuit, with reset, to provide a smooth analog output voltage to the Arduino.</li> </ul> <p>A <a href="https://github.com/rcollins130/TRACBOT-models" rel="external nofollow noopener" target="_blank">Python program</a> was written to aid in calculation of the required amplification gains, cutoff frequencies, and component values in each stage of the circuit. The <a href="https://pypi.org/project/eseries/" rel="external nofollow noopener" target="_blank">eseries library</a> was extremely helpful for determining the best combination of resistor and capacitor values to meet gain and frequency specifications.</p> <p>A video demonstrating use of the beacon sensor for initial orientation is provided in the Results section.</p> <h3 id="line-sensing">Line Sensing</h3> <p>The line sensing circuit utilizes three RPR220 IR reflective sensors. Reflective sensors contain both an IR LED and a reciever to measure the reflectance of a surface. If there is black tape, the sensor reads a low value which can be used to detect that the robot is above a line.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/TRACBOT21/assets/img/line_sensor_electronics-480.webp 480w,/TRACBOT21/assets/img/line_sensor_electronics-800.webp 800w,/TRACBOT21/assets/img/line_sensor_electronics-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/TRACBOT21/assets/img/line_sensor_electronics.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Line Sensor Circuit Diagram" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Three sensors were used primarily for robustness in the sensing capabilities of the robot. The resistors were tuned to provide a large voltage range in the measurements, and each sensor was connected to an Uno analog pin. This allows for the software to make a determination on if a line has been detected.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/TRACBOT21/assets/img/line_sensing_circuit-480.webp 480w,/TRACBOT21/assets/img/line_sensing_circuit-800.webp 800w,/TRACBOT21/assets/img/line_sensing_circuit-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/TRACBOT21/assets/img/line_sensing_circuit.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Line Sensor Electronics" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 id="inertial-measurement-unit">Inertial Measurement Unit</h3> <p>The IMU selected was the MPU6050. This IMU is powered off of a 3V3 supply from the Uno and communicates with the Uno via the I2C communication protocal. This unit hosts three acceleratometers and gyroscopes to measure accelerations and angular velocities respectively. However, the only sensor that was actively used in the software was the +Z gyro, which allowed us to measure the robot’s rotation rate.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/TRACBOT21/assets/img/imu-480.webp 480w,/TRACBOT21/assets/img/imu-800.webp 800w,/TRACBOT21/assets/img/imu-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/TRACBOT21/assets/img/imu.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="MPU6050 Inertial Measurement Unit" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The IMU was provided with its own hardware timer (ITimer1) to ensure that its measurements could be processed and integrated with the highest available precision. More information on how the IMU measurements were used in the software it provided in the software section.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Hugo Buurmeijer. Last updated: March 15, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/TRACBOT21/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/TRACBOT21/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/TRACBOT21/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/TRACBOT21/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/TRACBOT21/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/TRACBOT21/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>